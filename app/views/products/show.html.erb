<header class="flex items-center justify-between w-full px-6 pb-3 bg-marche_orange 2xl:px-[136px] xl:px-32 lg:px-[116px] md:px-28 sm:px-14 h-14">
  <section class="w-0 mb-1 mr-2 link link-hover md:min-w-fit">
    <%= image_tag "marche_logo_home.svg" ,class: "h-12 mb-1" %>
  </section>
  <div class="self-center mt-1 mb-2 sm:mr-6 md:mr-10 lg:mr-12 xl:mr-16">
    <%= search_form_for @ransack_q, url: search_path, class: "flex", data: {turbo: "false"} do |form|%>
      <%= form.search_field :name_cont, class: "w-60 2xl:w-[800px] xl:w-[640px] lg:w-[420px] md:w-68 sm:w-56 rounded-lg" %>
      <%= button_tag type: 'submit', class: "ml-2 fill-marche_white" do %>
        <%= raw('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 48 48" id="search"><path d="M46.599 40.236L36.054 29.691C37.89 26.718 39 23.25 39 19.5 39 8.73 30.27 0 19.5 0S0 8.73 0 19.5 8.73 39 19.5 39c3.75 0 7.218-1.11 10.188-2.943l10.548 10.545a4.501 4.501 0 0 0 6.363-6.366zM19.5 33C12.045 33 6 26.955 6 19.5S12.045 6 19.5 6 33 12.045 33 19.5 26.955 33 19.5 33z"></path></svg>') %>
      <% end %>
    <% end %>
  </div>
  <%= link_to(raw('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 24 24" class="mt-3 mr-3"><path d="M21.5,15a3,3,0,0,0-1.9-2.78l1.87-7a1,1,0,0,0-.18-.87A1,1,0,0,0,20.5,4H6.8L6.47,2.74A1,1,0,0,0,5.5,2h-2V4H4.73l2.48,9.26a1,1,0,0,0,1,.74H18.5a1,1,0,0,1,0,2H5.5a1,1,0,0,0,0,2H6.68a3,3,0,1,0,5.64,0h2.36a3,3,0,1,0,5.82,1,2.94,2.94,0,0,0-.4-1.47A3,3,0,0,0,21.5,15Zm-3.91-3H9L7.34,6H19.2ZM9.5,20a1,1,0,1,1,1-1A1,1,0,0,1,9.5,20Zm8,0a1,1,0,1,1,1-1A1,1,0,0,1,17.5,20Z"></path></svg>'), cart_path, class: "fill-marche_white mb-4 ml-3") %>
</header>
<div class="flex w-full max-w-2xl mx-auto">
  <div class="w-full mx-auto">
    <%= render 'shared/flash' if flash.any? %>
    <h1 class="self-end mt-5 mb-2 text-xl font-bold text-marche_orange" >檢視商品</h1>
    <%# 商品基本欄位 %>
    <div class="flex grid w-full grid-cols-2">
      <%# 圖片 %>
      <header class="mr-5 ">
        <div class="w-100 h-100">
          <img src="https://picsum.photos/350/400/" class="w-full">
        </div>
      </header>
      <%# 資訊詳情 %>
      <%= render partial: 'products/info', locals: {sale_info: @sale_info, product: @product, cart_product: @cart_product} %>
    </div>
    <%# 喜歡功能 %>
    <div data-controller="product--like" data-product-id="<%=@product.id%>" data-user-like="<%=current_user&.like_product?(@product)%>">
      <i class="fa-regular fa-heart fa-xl text-rose-600 hover:animate-bounce" data-action="click->product--like#like_product" data-product--like-target="heart"></i>
      <span>Like商品(<span data-product--like-target="amount"><%= @product.product_likes.count%></span>)</span>
    </div>
    <%# 商品詳情 %>
    <section>
      <div class="my-5">
        <strong class="block mb-1 font-medium">描述:</strong>
        <%= @product.description %>
      </div>
    </section>
  </div>
</div>
<%# Comment %>
<div class="max-w-2xl mx-auto ">
  <%# 留言輸入區 %>
  <h2 class="m-1 text-lg font-bold">商品評價</h2>
  <%= render partial: 'comments/comment_ranking', locals: {average_rating: @average_rating, product: @product} %>
  <% if user_signed_in? %>
    <%= form_with model: @product_comment, url: product_comments_path(@product.id) do |f| %>
      <div class="flex">
        <%= f.label "留下評論：", class: 'label'%>
        <div class="rating rating-md">
          <%= f.radio_button :rating, get_star_number(:star_0), class: "comment-star-hidden" , checked: "checked" %>
          <%= f.radio_button :rating, get_star_number(:star_1), class: "comment-star" %>
          <%= f.radio_button :rating, get_star_number(:star_2), class: "comment-star" %>
          <%= f.radio_button :rating, get_star_number(:star_3), class: "comment-star" %>
          <%= f.radio_button :rating, get_star_number(:star_4), class: "comment-star" %>
          <%= f.radio_button :rating, get_star_number(:star_5), class: "comment-star"%>
        </div>
      </div>
      <div class="flex items-end">
        <%= f.text_area :content, class: "comment-textarea w-full max-w-xs"%>
        <%= f.submit "Send", class: "comment-btn-sm" %>
      </div>
    <% end %>
  <% end %>
  <%# 當前產品評論 %>
  <section>
    <h3 class="m-2">評論：</h3>
    <div id="comment-list">
      <%= render partial: 'comments/comment', collection: @comment_records %>
    </div>
    <div class="flex justify-center my-4"><%== pagy_nav(@pagy) if @pagy.pages > 1 %></div>
  </section>
</div>
